<!DOCTYPE html>
<html lang="ar">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Studio10 - الصفحة الرئيسية</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* إزالة الخلفية والحدود من حاوية التاريخ */
    .date-display {
      background: none;
      border: none;
      box-shadow: none;
      padding: 0;
      margin-bottom: 30px;
      text-align: right;
      /* محاذاة لليمين لتناسق أفضل */
    }
  </style>
</head>

<body>
  <header>
    <div class="container">
      <div class="header-top">
        <a href="index.html" class="logo">
          <i class="fas fa-cogs"></i>
          صندوق | box
        </a>
        <div class="header-actions">
          <button onclick="logout()" title="تسجيل الخروج"><i class="fas fa-sign-out-alt"></i></button>
        </div>
      </div>
      <nav>
        <a href="index.html" class="active">
          <i class="fas fa-home"></i>
          <span>الرئيسية</span>
        </a>
        <a href="members.html">
          <i class="fas fa-users"></i>
          <span>الأعضاء</span>
        </a>
        <a href="deposit.html">
          <i class="fas fa-wallet"></i>
          <span>إيداع</span>
        </a>
        <a href="withdraw.html">
          <i class="fas fa-university"></i>
          <span>سحب</span>
        </a>
        <a href="reports.html">
          <i class="fas fa-chart-bar"></i>
          <span>تقارير</span>
        </a>
        <a href="users.html">
          <i class="fas fa-user-cog"></i>
          <span>المستخدمين</span>
        </a>
        <a href="settings.html">
          <i class="fas fa-cog"></i>
          <span>الإعدادات</span>
        </a>
      </nav>
    </div>
  </header>
  <main>
    <div class="container">
      <div class="date-display"></div>

      <!-- ⭐️ قسم أرصدة الصناديق في لوحة التحكم -->
      <section id="dashboard-boxes-section" style="margin-bottom: 30px;">
        <h3 style="margin-bottom: 15px; color: var(--primary-color); font-size: 16px;">الرصيد</h3>
        <div id="dashboard-boxes-container" class="dashboard-grid"></div>
      </section>

      <section>
        <h3 style="margin-bottom: 15px; color: var(--primary-color); font-size: 16px;">وصول سريع</h3>
        <div class="grid">
          <a href="members.html" class="grid-item">
            <div class="grid-item-icon"><i class="fas fa-users"></i></div>
            <div class="grid-item-label">الأعضاء</div>
          </a>
          <a href="deposit.html" class="grid-item">
            <div class="grid-item-icon"><i class="fas fa-money-bill-wave"></i></div>
            <div class="grid-item-label">إيداع</div>
          </a>
          <a href="withdraw.html" class="grid-item">
            <div class="grid-item-icon"><i class="fas fa-university"></i></div>
            <div class="grid-item-label">سحب</div>
          </a>
          <a href="reports.html" class="grid-item">
            <div class="grid-item-icon"><i class="fas fa-chart-bar"></i></div>
            <div class="grid-item-label">تقارير</div>
          </a>
        </div>
      </section>
    </div>
  </main>

  <!-- Confirmation Modal -->
  <div id="confirmationModal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
      <div class="modal-header">
        <h3 id="confirmationModalTitle" class="modal-title">تأكيد الإجراء</h3>
        <button class="modal-close" onclick="closeConfirmationModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p id="confirmationModalText">هل أنت متأكد من رغبتك في المتابعة؟</p>
      </div>
      <div class="modal-footer">
        <button id="cancelBtn" class="btn" onclick="closeConfirmationModal()">إلغاء</button>
        <button id="confirmBtn" class="btn primary" onclick="handleConfirm()">تأكيد</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <p>&copy; 2024 Studio10 للأنظمة الإدارية. جميع الحقوق محفوظة.</p>
    </div>
  </footer>

  <script src="script.js"></script>
  <script>
    // التحقق من تسجيل الدخول
    document.addEventListener('DOMContentLoaded', function () {
      const isLoggedIn = localStorage.getItem('isLoggedIn');
      if (isLoggedIn !== 'true') {
        window.location.href = 'login.html';
        return;
      }

      // عرض التاريخ بتنسيق رقمي
      // ⭐️ تم التعديل: عرض التاريخين الهجري والميلادي معاً
      const today = new Date();

      // اليوم
      const dayName = today.toLocaleDateString('ar-SA', { weekday: 'long' });

      // ⭐️ تم التعديل: تنسيق التاريخ الهجري بالشكل المطلوب (D-M-YYYY هـ)
      // نستخدم 'en-u-ca-islamic' للحصول على أرقام غربية ثم نعيد ترتيبها
      const hijriFormatter = new Intl.DateTimeFormat('en-u-ca-islamic', { day: 'numeric', month: 'numeric', year: 'numeric' });
      const hijriParts = hijriFormatter.formatToParts(today);
      const hijriDay = hijriParts.find(p => p.type === 'day').value;
      const hijriMonth = hijriParts.find(p => p.type === 'month').value;
      const hijriYear = hijriParts.find(p => p.type === 'year').value.split(' ')[0]; // لإزالة "AH"
      const hijriDate = `${hijriDay}-${hijriMonth}-${hijriYear} هـ`;

      // التاريخ الميلادي بالتنسيق المطلوب (DD-MM-YYYYم)
      const gregorianDate = `${today.getDate().toString().padStart(2, '0')}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getFullYear()}م`;

      const formattedDate = `${dayName} | ${hijriDate}، ${gregorianDate}`;
      const dateDisplay = document.querySelector('.date-display');
      if (dateDisplay) dateDisplay.textContent = formattedDate;

      // ⭐️ عرض أرصدة الصناديق
      renderDashboardBoxBalances('dashboard-boxes-container');
    });

    function logout() {
      const message = 'هل أنت متأكد من رغبتك في تسجيل الخروج؟';
      showConfirmationModal(message, () => {
        localStorage.setItem('isLoggedIn', 'false');
        localStorage.removeItem('currentUser');
        showAlert('تم تسجيل الخروج بنجاح', 'success');
        setTimeout(() => {
          window.location.href = 'login.html';
        }, 1000);
      });
    }
  </script>
</body>

</html>